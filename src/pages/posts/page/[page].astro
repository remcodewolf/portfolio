---
import type { PaginateFunction } from "astro";
import { getCollection } from "astro:content";
import PageLayout from "../../../layouts/PageLayout.astro";
import BlogPost from "../../../components/BlogPost.astro";

export async function getStaticPaths({
  paginate,
}: {
  paginate: PaginateFunction;
}) {
  const allPosts = await getCollection("blog");
  console.log("Aantal posts gevonden:", allPosts.length);

  return paginate(allPosts, { pageSize: 6 });
}
const { page } = Astro.props;
const pageTitle = "Blog";
---

<PageLayout pageTitle={pageTitle}>
  <div class="mx-auto max-w-7xl shadow-md min-h-full p-4">
    <h1 class="text-5xl font-bold text-center">
      Blog Pagina {page.currentPage}
    </h1>
    <div class="flex flex-col justify-around h-full">
      <p class="p-4">
        This is where I will post about my journey learning Astro.
      </p>
      <ul
        class="w-full grid grid-cols-[repeat(auto-fit,minmax(300px,1fr))] gap-6"
      >
        {
          page.data.map((post: any) => (
            <BlogPost
              url={`/posts/${post.id}/`}
              title={post.data.title}
              cover={post.data.cover}
              coverAlt={post.data.coverAlt}
              description={post.data.description}
            />
          ))
        }
      </ul>
      <div class="flex gap-4 justify-center mt-6">
        {
          page.url.first ? (
            <a href={`/posts/page/1`} class="underline">
              First
            </a>
          ) : null
        }
        {
          page.url.prev ? (
            <a href={`/posts/page/${page.currentPage - 1}`} class="underline">
              Previous
            </a>
          ) : null
        }
        {
          page.url.next ? (
            <a href={`/posts/page/${page.currentPage + 1}`} class="underline">
              Next
            </a>
          ) : null
        }
        {
          page.url.last ? (
            <a href={`/posts/page/${page.lastPage}`} class="underline">
              Last
            </a>
          ) : null
        }
      </div>
    </div>
  </div>
</PageLayout>
